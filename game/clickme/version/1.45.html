<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle Clicker Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb, #90caf9);
            height: 100dvh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 0 0 15px 15px;
            flex-shrink: 0;
        }

        .game-title {
            color: #1565c0;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .sound-toggle {
            position: absolute;
            top: 15px;
            right: 20px;
            background: #42a5f5;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
        }

        /* Main Game Area */
        .game-container {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 300px 1fr;
            gap: 20px;
            padding: 20px;
            align-items: start;
            overflow-y: auto;
        }

        /* Character Area */
        .character-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .character-container {
            position: relative;
            width: 200px;
            height: 250px;
            margin-bottom: 20px;
        }

        .character {
            width: 100px;
            height: 150px;
            background: #64b5f6;
            border-radius: 50px 50px 20px 20px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: idle 2s ease-in-out infinite;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .character:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .character:active {
            transform: translate(-50%, -50%) scale(0.95);
        }

        @keyframes idle {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-5px); }
        }

        /* Equipment Slots */
        .equipment {
            position: absolute;
        }

        .hat {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 30px;
            background: #f44336;
            border-radius: 30px 30px 0 0;
            display: none;
        }

        .glasses {
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 20px;
            background: #424242;
            border-radius: 10px;
            display: none;
        }

        .vehicle {
            top: 100px;
            right: -80px;
            width: 80px;
            height: 40px;
            background: #ff9800;
            border-radius: 10px;
            display: none;
        }

        /* Stats */
        .stats {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }

        .stat-item {
            margin: 8px 0;
            color: #1565c0;
            font-weight: bold;
        }

        /* Prestige Stats */
        .prestige-stats {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #ffc107;
            padding: 10px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 15px;
        }

        .prestige-stat {
            margin: 5px 0;
            color: #f57c00;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Control Panel */
        .control-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .click-button {
            background: linear-gradient(135deg, #42a5f5, #1976d2);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .click-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.3);
        }

        .click-button:active {
            transform: scale(0.95);
        }

        /* Upgrades */
        .upgrades {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .upgrade-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #42a5f5;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9rem;
            position: relative;
        }

        .upgrade-btn:hover {
            background: #42a5f5;
            color: white;
        }

        .upgrade-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Upgrade Available Indicator */
        .upgrade-btn.available {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            animation: pulse 2s infinite;
        }

        .upgrade-btn.available::after {
            content: '✨';
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff9800;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }

        /* Shop Button */
        .shop-btn {
            background: linear-gradient(135deg, #66bb6a, #388e3c);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .shop-btn:hover {
            transform: translateY(-2px);
        }

        /* Prestige Button */
        .prestige-btn {
            background: linear-gradient(135deg, #ffc107, #ff8f00);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 20px;
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .prestige-btn:hover {
            background: linear-gradient(135deg, #ff8f00, #ff6f00);
            transform: translateY(-1px);
        }

        .prestige-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Reset Button */
        .reset-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .reset-btn:hover {
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
            transform: translateY(-1px);
        }

        /* Save Status Indicator */
        .save-status {
            position: fixed;
            top: 70px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1001;
        }

        .save-status.show {
            opacity: 1;
        }

        .save-status.error {
            background: rgba(244, 67, 54, 0.9);
        }

        /* Achievement Notification */
        .achievement-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            opacity: 0;
            transition: all 0.3s;
            z-index: 1002;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .achievement-notification.show {
            opacity: 1;
            transform: translateX(-10px);
        }

        /* Daily Reward Notification */
        .daily-reward-notification {
            position: fixed;
            top: 130px;
            right: 20px;
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            opacity: 0;
            transition: all 0.3s;
            z-index: 1003;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .daily-reward-notification.show {
            opacity: 1;
            transform: translateX(-10px);
        }

        /* Popups */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .popup {
            background: white;
            border-radius: 20px;
            padding: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #e3f2fd;
            padding-bottom: 10px;
        }

        .popup-title {
            color: #1565c0;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            position: absolute; /* atau fixed */
            z-index: 1000;
            top: 10px; /* sesuaikan posisi */
            right: 10px; /* sesuaikan posisi */
        }


        /* Shop Tabs */
        .shop-tabs {
            display: flex;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
        }

        .tab-btn {
            flex: 1;
            background: #e3f2fd;
            border: none;
            padding: 12px;
            cursor: pointer;
            font-weight: bold;
            color: #1565c0;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: #42a5f5;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Shop Items */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .shop-item {
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .shop-item:hover {
            border-color: #42a5f5;
            transform: translateY(-2px);
        }

        .item-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .item-name {
            font-weight: bold;
            color: #1565c0;
            margin-bottom: 5px;
        }

        .item-price {
            color: #666;
            margin-bottom: 10px;
        }

        .buy-btn {
            background: #42a5f5;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .buy-btn:hover {
            background: #1976d2;
        }

        .buy-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .buy-btn.owned {
            background: #4caf50;
            cursor: default;
        }

        .buy-btn.owned:hover {
            background: #4caf50;
        }

        /* Achievement Grid */
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .achievement-item {
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .achievement-item.completed {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .achievement-name {
            font-weight: bold;
            color: #1565c0;
            margin-bottom: 5px;
        }

        .achievement-desc {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .achievement-progress {
            background: #e0e0e0;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .achievement-progress-bar {
            background: #42a5f5;
            height: 100%;
            transition: width 0.3s;
        }

        .achievement-progress-bar.completed {
            background: #4caf50;
        }

        .achievement-reward {
            color: #ff9800;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Prestige Items */
        .prestige-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .prestige-item {
            background: linear-gradient(135deg, #fff3e0, #ffcc02);
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .prestige-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
        }

        .prestige-item.owned {
            background: linear-gradient(135deg, #e8f5e8, #4caf50);
            border-color: #4caf50;
        }

        /* Inventory */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .inventory-item {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }

        .equip-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .equip-btn.equipped {
            background: #f44336;
        }

        /* Notification Popup */
        .notification-popup {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .notification-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .notification-title {
            color: #1565c0;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .notification-message {
            color: #666;
            margin-bottom: 20px;
        }

        .notification-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .notification-btn {
            background: #42a5f5;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .notification-btn:hover {
            background: #1976d2;
        }

        .notification-btn.secondary {
            background: #66bb6a;
        }

        .notification-btn.secondary:hover {
            background: #388e3c;
        }

        .notification-btn.warning {
            background: #ff9800;
        }

        .notification-btn.warning:hover {
            background: #f57c00;
        }

        /* Daily Reward Calendar */
        .daily-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .daily-day {
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .daily-day.claimed {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .daily-day.today {
            background: #e3f2fd;
            border-color: #42a5f5;
            animation: pulse-blue 2s infinite;
        }

        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(66, 165, 245, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(66, 165, 245, 0); }
            100% { box-shadow: 0 0 0 0 rgba(66, 165, 245, 0); }
        }

        .daily-day-number {
            font-weight: bold;
            color: #1565c0;
            margin-bottom: 5px;
        }

        .daily-reward-amount {
            color: #ff9800;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
                gap: 0;
                padding: 10px 10px 0 10px;
                height: calc(100dvh - 60px);
            }

            .character-section {
                order: 1;
                justify-content: center;
                min-height: 0;
                padding: 10px 0;
            }

            .character-container {
                width: 150px;
                height: 180px;
                margin-bottom: 15px;
            }

            .character {
                width: 80px;
                height: 120px;
            }

            .stats, .prestige-stats {
                padding: 8px 12px;
                font-size: 0.85rem;
                margin-bottom: 10px;
            }

            .stat-item, .prestige-stat {
                margin: 4px 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .control-panel {
                order: 2;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.98);
                padding: 8px 10px 8px 10px;
                border-radius: 15px 15px 0 0;
                box-shadow: 0 -3px 15px rgba(0,0,0,0.15);
                backdrop-filter: blur(10px);
                z-index: 100;
                max-height: 50vh;
                overflow-y: auto;
            }

            .click-button {
                padding: 12px 16px;
                font-size: 0.95rem;
                margin-bottom: 8px;
                border-radius: 25px;
            }

            .upgrades {
                grid-template-columns: 1fr 1fr;
                gap: 6px;
                margin-bottom: 8px;
            }

            .upgrade-btn {
                padding: 6px 8px;
                font-size: 0.75rem;
                border-radius: 8px;
                min-height: 60px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }

            .upgrade-btn small {
                font-size: 0.65rem;
                line-height: 1.2;
            }

            .shop-buttons {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                gap: 6px;
                margin-bottom: 8px;
            }

            .shop-btn {
                padding: 8px 8px;
                font-size: 0.8rem;
                border-radius: 15px;
                margin-bottom: 0;
            }

            .prestige-btn, .reset-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                margin-top: 6px;
            }

            .header {
                padding: 6px 15px;
            }

            .game-title {
                font-size: 1.1rem;
            }

            .sound-toggle {
                padding: 4px 8px;
                font-size: 0.8rem;
                top: 8px;
                right: 15px;
            }

            .save-status, .achievement-notification, .daily-reward-notification {
                top: 45px;
                right: 15px;
                font-size: 0.7rem;
                padding: 3px 8px;
            }

            .achievement-notification {
                top: 65px;
            }

            .daily-reward-notification {
                top: 85px;
            }

            .popup {
                width: 95%;
                max-height: 85vh;
                border-radius: 15px;
            }

            .popup-title {
                font-size: 1.2rem;
            }

            

            .shop-tabs {
                flex-direction: row;
            }

            .tab-btn {
                padding: 8px 4px;
                font-size: 0.75rem;
            }

            .shop-grid, .inventory-grid, .achievement-grid, .prestige-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .shop-item, .inventory-item, .achievement-item, .prestige-item {
                padding: 10px;
            }

            .item-icon, .achievement-icon {
                font-size: 1.5rem;
            }

            .notification-popup {
                padding: 20px;
                max-width: 350px;
            }

            .notification-icon {
                font-size: 2rem;
            }

            .notification-title {
                font-size: 1.1rem;
            }

            .notification-btn {
                padding: 8px 15px;
                font-size: 0.85rem;
            }

            .daily-calendar {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }

            .daily-day {
                padding: 10px 5px;
            }

            .daily-day-number {
                font-size: 0.9rem;
            }

            .daily-reward-amount {
                font-size: 0.7rem;
            }
        }

        @media (max-width: 480px) {
            .character {
                width: 70px;
                height: 100px;
            }

            .character-container {
                width: 130px;
                height: 150px;
            }

            .stats, .prestige-stats {
                padding: 6px 10px;
                font-size: 0.8rem;
            }

            .upgrade-btn {
                padding: 4px 6px;
                font-size: 0.7rem;
                min-height: 50px;
            }

            .click-button {
                padding: 10px 14px;
                font-size: 0.9rem;
            }

            .control-panel {
                padding: 6px 8px 6px 8px;
            }

            .shop-buttons {
                grid-template-columns: 1fr 1fr;
                gap: 4px;
            }

            .shop-btn {
                padding: 6px 6px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Elements -->
    <audio id="clickSound" preload="auto">
        <source src="sounds/click.mp3" type="audio/mpeg">
        <source src="sounds/click.wav" type="audio/wav">
        <source src="sounds/click.ogg" type="audio/ogg">
    </audio>
    
    <audio id="buySound" preload="auto">
        <source src="sounds/buy.mp3" type="audio/mpeg">
        <source src="sounds/buy.wav" type="audio/wav">
        <source src="sounds/buy.ogg" type="audio/ogg">
    </audio>
    
    <audio id="openSound" preload="auto">
        <source src="sounds/open.mp3" type="audio/mpeg">
        <source src="sounds/open.wav" type="audio/wav">
        <source src="sounds/open.ogg" type="audio/ogg">
    </audio>
    
    <audio id="closeSound" preload="auto">
        <source src="sounds/close.mp3" type="audio/mpeg">
        <source src="sounds/close.wav" type="audio/wav">
        <source src="sounds/close.ogg" type="audio/ogg">
    </audio>

    <!-- Notifications -->
    <div class="save-status" id="saveStatus">💾 Game Saved!</div>
    <div class="achievement-notification" id="achievementNotification">🏆 Achievement Unlocked!</div>
    <div class="daily-reward-notification" id="dailyRewardNotification">🎁 Daily Reward!</div>

    <!-- Header -->
    <div class="header">
        <h1 class="game-title">🎮 Idle Clicker Game</h1>
        <button class="sound-toggle" onclick="toggleSound()">🔊 <span id="soundStatus">On</span></button>
    </div>

    <!-- Main Game Area -->
    <div class="game-container">
        <!-- Character Section -->
        <div class="character-section">
            <div class="character-container">
                <div class="character" onclick="clickCharacter()"></div>
                <!-- Equipment Slots -->
                <div class="equipment hat" id="hat"></div>
                <div class="equipment glasses" id="glasses"></div>
                <div class="equipment vehicle" id="vehicle"></div>
            </div>
            
            <div class="stats">
                <div class="stat-item">💰 <span id="points">0</span></div>
                <div class="stat-item">⚡ <span id="pointsPerSecond">0</span>/s</div>
                <div class="stat-item">🔥 Lv.<span id="level">1</span></div>
                <div class="stat-item">🎯 <span id="totalClicks">0</span></div>
                <div class="stat-item">⏰ <span id="playTime">0</span>s</div>
                <div class="stat-item">💎 <span id="ownedItems">0</span></div>
            </div>

            <div class="prestige-stats">
                <div class="prestige-stat">🌟 Prestige: <span id="prestigeLevel">0</span></div>
                <div class="prestige-stat">⭐ Points: <span id="prestigePoints">0</span></div>
                <div class="prestige-stat">📈 Multiplier: x<span id="prestigeMultiplier">1</span></div>
                <div class="prestige-stat">🔥 Streak: <span id="dailyStreak">0</span></div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <button class="click-button" onclick="clickCharacter()">🖱️ Klik Saya!</button>
            
            <div class="upgrades">
                <button class="upgrade-btn" onclick="buyUpgrade('autoClicker')" id="autoClickerBtn">
                    🤖 Auto<br>
                    <small>💰 <span id="autoClickerCost">10</span></small><br>
                    <small>Lv: <span id="autoClickerLevel">0</span></small>
                </button>
                
                <button class="upgrade-btn" onclick="buyUpgrade('clickPower')" id="clickPowerBtn">
                    💪 Power<br>
                    <small>💰 <span id="clickPowerCost">50</span></small><br>
                    <small>Lv: <span id="clickPowerLevel">1</span></small>
                </button>
            </div>
            
            <div class="shop-buttons">
                <button class="shop-btn" onclick="openShop()">🛍️ Toko</button>
                <button class="shop-btn" onclick="openInventory()" style="background: linear-gradient(135deg, #ab47bc, #7b1fa2);">🎒 Items</button>
                <button class="shop-btn" onclick="openAchievements()" style="background: linear-gradient(135deg, #ff9800, #f57c00);">🏆 Prestasi</button>
            </div>

            <button class="prestige-btn" onclick="openPrestige()" id="prestigeBtn">🌟 Prestige (Need 1000 Points)</button>
            <button class="reset-btn" onclick="confirmReset()">🔄 Reset Game</button>
        </div>
    </div>

    <!-- Shop Popup -->
    <div class="popup-overlay" id="shopPopup">
        <div class="popup">
            <div class="popup-header">
                <h2 class="popup-title">🛍️ Toko</h2>
                <button class="close-btn" onclick="closeShop()">×</button>
            </div>
            
            <div class="shop-tabs">
                <button class="tab-btn active" onclick="switchTab('accessories')">🎭 Aksesoris</button>
                <button class="tab-btn" onclick="switchTab('characters')">👤 Karakter</button>
                <button class="tab-btn" onclick="switchTab('themes')">🎨 Tema</button>
            </div>
            
            <div class="tab-content active" id="accessories">
                <div class="shop-grid" id="accessoriesGrid"></div>
            </div>
            
            <div class="tab-content" id="characters">
                <div class="shop-grid" id="charactersGrid"></div>
            </div>
            
            <div class="tab-content" id="themes">
                <div class="shop-grid" id="themesGrid"></div>
            </div>
        </div>
    </div>

    <!-- Inventory Popup -->
    <div class="popup-overlay" id="inventoryPopup">
        <div class="popup">
            <div class="popup-header">
                <h2 class="popup-title">🎒 Inventory</h2>
                <button class="close-btn" onclick="closeInventory()">×</button>
            </div>
            <div class="inventory-grid" id="inventoryGrid">
                <div style="text-align: center; color: #666; grid-column: 1 / -1; padding: 50px;">
                    Belum ada item yang dimiliki
                </div>
            </div>
        </div>
    </div>

    <!-- Achievements Popup -->
    <div class="popup-overlay" id="achievementsPopup">
        <div class="popup">
            <div class="popup-header">
                <h2 class="popup-title">🏆 Prestasi</h2>
                <button class="close-btn" onclick="closeAchievements()">×</button>
            </div>
            
            <div class="shop-tabs">
                <button class="tab-btn active" onclick="switchAchievementTab('clicks')">🖱️ Klik</button>
                <button class="tab-btn" onclick="switchAchievementTab('points')">💰 Poin</button>
                <button class="tab-btn" onclick="switchAchievementTab('upgrades')">⚡ Upgrade</button>
                <button class="tab-btn" onclick="switchAchievementTab('daily')">🎁 Harian</button>
            </div>
            
            <div class="tab-content active" id="clicksAchievements">
                <div class="achievement-grid" id="clicksAchievementGrid"></div>
            </div>
            
            <div class="tab-content" id="pointsAchievements">
                <div class="achievement-grid" id="pointsAchievementGrid"></div>
            </div>
            
            <div class="tab-content" id="upgradesAchievements">
                <div class="achievement-grid" id="upgradesAchievementGrid"></div>
            </div>
            
            <div class="tab-content" id="dailyAchievements">
                <div class="daily-calendar" id="dailyCalendar"></div>
                <button class="notification-btn" onclick="claimDailyReward()" id="claimDailyBtn">🎁 Klaim Reward Harian</button>
            </div>
        </div>
    </div>

    <!-- Prestige Popup -->
    <div class="popup-overlay" id="prestigePopup">
        <div class="popup">
            <div class="popup-header">
                <h2 class="popup-title">🌟 Prestige</h2>
                <button class="close-btn" onclick="closePrestige()">×</button>
            </div>
            
            <div class="shop-tabs">
                <button class="tab-btn active" onclick="switchPrestigeTab('info')">📊 Info</button>
                <button class="tab-btn" onclick="switchPrestigeTab('shop')">🛒 Prestige Shop</button>
            </div>
            
            <div class="tab-content active" id="prestigeInfo">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 1.2rem; font-weight: bold; color: #ff9800; margin-bottom: 10px;">
                        🌟 Prestige akan reset progress kamu tapi memberikan:
                    </div>
                    <div style="margin: 10px 0;">⭐ <span id="nextPrestigePoints">0</span> Prestige Points</div>
                    <div style="margin: 10px 0;">📈 Permanent income multiplier</div>
                    <div style="margin: 10px 0;">🛒 Akses Prestige Shop</div>
                    <div style="margin: 10px 0; color: #f44336;">⚠️ Memerlukan minimal 1000 poin</div>
                </div>
                <button class="notification-btn warning" onclick="doPrestige()" id="doPrestigeBtn" disabled>🌟 PRESTIGE SEKARANG</button>
            </div>
            
            <div class="tab-content" id="prestigeShop">
                <div class="prestige-grid" id="prestigeShopGrid"></div>
            </div>
        </div>
    </div>

    <!-- Offline Earnings Popup -->
    <div class="popup-overlay" id="offlinePopup">
        <div class="notification-popup">
            <div class="notification-icon">💤</div>
            <div class="notification-title">Welcome Back!</div>
            <div class="notification-message" id="offlineMessage">Kamu offline selama 5 menit dan mendapat 150 poin!</div>
            <div class="notification-buttons">
                <button class="notification-btn" onclick="closeOfflinePopup()">Terima Kasih!</button>
            </div>
        </div>
    </div>

    <!-- Reset Confirmation Popup -->
    <div class="popup-overlay" id="resetPopup">
        <div class="notification-popup">
            <div class="notification-icon">⚠️</div>
            <div class="notification-title">Reset Game</div>
            <div class="notification-message">Apakah Anda yakin ingin mereset semua progress? Data tidak dapat dikembalikan!</div>
            <div class="notification-buttons">
                <button class="notification-btn" onclick="resetGame(); closeResetPopup();">Ya, Reset</button>
                <button class="notification-btn secondary" onclick="closeResetPopup()">Batal</button>
            </div>
        </div>
    </div>

    <!-- Notification Popup -->
    <div class="popup-overlay" id="notificationPopup">
        <div class="notification-popup">
            <div class="notification-icon" id="notificationIcon">🎉</div>
            <div class="notification-title" id="notificationTitle">Item Berhasil Dibeli!</div>
            <div class="notification-message" id="notificationMessage">Item telah ditambahkan ke inventory Anda.</div>
            <div class="notification-buttons">
                <button class="notification-btn" onclick="closeNotification(); openInventory();">Lihat Inventory</button>
                <button class="notification-btn secondary" onclick="closeNotification()">Ok!</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== LOCAL STORAGE SYSTEM ====================
        const SAVE_KEY = 'idleClickerGameData';
        const SAVE_VERSION = '2.0';

        // Default Game State
        const defaultGameState = {
            version: SAVE_VERSION,
            points: 0,
            pointsPerSecond: 0,
            clickPower: 1,
            autoClickerLevel: 0,
            clickPowerLevel: 1,
            totalClicks: 0,
            playTime: 0,
            ownedItems: [],
            equippedItems: {},
            soundEnabled: true,
            lastSaved: Date.now(),
            totalPlaytime: 0,
            
            // Achievement System
            achievements: {},
            completedAchievements: [],
            
            // Prestige System
            prestigeLevel: 0,
            prestigePoints: 0,
            prestigeMultiplier: 1,
            prestigeUpgrades: {},
            totalPrestigePoints: 0,
            
            // Daily Rewards
            lastDailyReward: 0,
            dailyStreak: 0,
            dailyRewardsClaimed: [],
            
            // Offline Earnings
            lastActiveTime: Date.now()
        };

        // Game State
        let gameState = { ...defaultGameState };

        // ==================== ACHIEVEMENTS DATA ====================
        const achievements = {
            clicks: [
                { id: 'first_click', name: 'First Click', desc: 'Click 1 time', target: 1, reward: 10, icon: '🖱️' },
                { id: 'click_10', name: 'Getting Started', desc: 'Click 10 times', target: 10, reward: 25, icon: '👆' },
                { id: 'click_100', name: 'Clicking Master', desc: 'Click 100 times', target: 100, reward: 100, icon: '🏆' },
                { id: 'click_1000', name: 'Click Legend', desc: 'Click 1,000 times', target: 1000, reward: 500, icon: '⚡' },
                { id: 'click_10000', name: 'Click God', desc: 'Click 10,000 times', target: 10000, reward: 2000, icon: '👑' }
            ],
            points: [
                { id: 'points_100', name: 'First Hundred', desc: 'Earn 100 points', target: 100, reward: 50, icon: '💰' },
                { id: 'points_1000', name: 'Thousand Club', desc: 'Earn 1,000 points', target: 1000, reward: 200, icon: '💎' },
                { id: 'points_10000', name: 'Ten K Rich', desc: 'Earn 10,000 points', target: 10000, reward: 1000, icon: '💸' },
                { id: 'points_100000', name: 'Millionaire', desc: 'Earn 100,000 points', target: 100000, reward: 5000, icon: '🏦' }
            ],
            upgrades: [
                { id: 'auto_1', name: 'First Auto', desc: 'Buy first auto clicker', target: 1, reward: 100, icon: '🤖' },
                { id: 'auto_10', name: 'Auto Master', desc: 'Reach auto clicker level 10', target: 10, reward: 500, icon: '⚙️' },
                { id: 'power_10', name: 'Power Up', desc: 'Reach click power level 10', target: 10, reward: 300, icon: '💪' },
                { id: 'first_item', name: 'Shopper', desc: 'Buy your first item', target: 1, reward: 200, icon: '🛒' }
            ]
        };

        // ==================== PRESTIGE SHOP DATA ====================
        const prestigeShop = [
            { id: 'click_multiplier', name: 'Click Multiplier', desc: 'Increase click power by 50%', cost: 1, effect: 'clickMultiplier', value: 1.5, icon: '💪' },
            { id: 'auto_multiplier', name: 'Auto Multiplier', desc: 'Increase auto income by 100%', cost: 2, effect: 'autoMultiplier', value: 2, icon: '🤖' },
            { id: 'offline_multiplier', name: 'Offline Multiplier', desc: 'Increase offline earnings by 200%', cost: 3, effect: 'offlineMultiplier', value: 3, icon: '💤' },
            { id: 'daily_bonus', name: 'Daily Bonus', desc: 'Increase daily rewards by 100%', cost: 2, effect: 'dailyMultiplier', value: 2, icon: '🎁' }
        ];

        // ==================== SHOP ITEMS DATA ====================
        const shopItems = {
            accessories: [
                { id: 'hat', name: 'Topi Keren', icon: '🎩', price: 100 },
                { id: 'glasses', name: 'Kacamata Hitam', icon: '🕶️', price: 200 },
                { id: 'motorcycle', name: 'Motor Sport', icon: '🏍️', price: 500 },
                { id: 'car', name: 'Mobil Mewah', icon: '🚗', price: 1000 }
            ],
            characters: [
                { id: 'wizard', name: 'Wizard', icon: '🧙‍♂️', price: 300 },
                { id: 'superhero', name: 'Superhero', icon: '🦸‍♂️', price: 800 }
            ],
            themes: [
                { id: 'darkTheme', name: 'Tema Malam', icon: '🌙', price: 150 },
                { id: 'rainbowTheme', name: 'Tema Pelangi', icon: '🌈', price: 250 }
            ]
        };

        // ==================== SAVE/LOAD FUNCTIONS ====================
        function saveGame() {
            try {
                gameState.lastSaved = Date.now();
                gameState.lastActiveTime = Date.now();
                const saveData = JSON.stringify(gameState);
                localStorage.setItem(SAVE_KEY, saveData);
                showSaveStatus('💾 Game Saved!', false);
                return true;
            } catch (error) {
                console.error('Save failed:', error);
                showSaveStatus('❌ Save Failed!', true);
                return false;
            }
        }

        function loadGame() {
            try {
                const savedData = localStorage.getItem(SAVE_KEY);
                if (savedData) {
                    const loadedState = JSON.parse(savedData);
                    if (loadedState.version === SAVE_VERSION) {
                        gameState = { ...defaultGameState, ...loadedState };
                        console.log('Game loaded successfully!');
                        showSaveStatus('📂 Game Loaded!', false);
                        return true;
                    } else {
                        console.log('Save version mismatch, starting fresh');
                        return false;
                    }
                } else {
                    console.log('No save data found, starting new game');
                    return false;
                }
            } catch (error) {
                console.error('Load failed:', error);
                showSaveStatus('❌ Load Failed!', true);
                return false;
            }
        }

        function resetGame() {
            try {
                localStorage.removeItem(SAVE_KEY);
                gameState = { ...defaultGameState };
                gameState.lastActiveTime = Date.now();
                
                updateDisplay();
                updateEquipment();
                updateShop();
                updateInventory();
                updateAchievements();
                updatePrestigeDisplay();
                
                console.log('Game reset successfully!');
                showSaveStatus('🔄 Game Reset!', false);
            } catch (error) {
                console.error('Reset failed:', error);
                showSaveStatus('❌ Reset Failed!', true);
            }
        }

        function initAutoSave() {
            setInterval(() => {
                saveGame();
            }, 30000);

            window.addEventListener('beforeunload', () => {
                saveGame();
            });

            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    saveGame();
                } else {
                    checkOfflineEarnings();
                }
            });
        }

        // ==================== SOUND FUNCTIONS ====================
        function playSound(soundId) {
            if (!gameState.soundEnabled) return;
            
            try {
                const audio = document.getElementById(soundId);
                if (audio) {
                    audio.currentTime = 0;
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.log('Audio play failed:', error);
                            try {
                                audio.play();
                            } catch(e) {
                                console.log('Audio fallback failed:', e);
                            }
                        });
                    }
                }
            } catch (error) {
                console.log('Sound error:', error);
            }
        }

        function preloadAudio() {
            const audioIds = ['clickSound', 'buySound', 'openSound', 'closeSound'];
            audioIds.forEach(id => {
                const audio = document.getElementById(id);
                if (audio) {
                    audio.load();
                }
            });
        }

        // ==================== GAME LOGIC ====================
        function clickCharacter() {
            playSound('clickSound');
            
            const clickPower = getEffectiveClickPower();
            gameState.points += clickPower;
            gameState.totalClicks++;
            
            updateDisplay();
            checkAchievements();
            
            // Click animation
            const character = document.querySelector('.character');
            character.style.animation = 'none';
            setTimeout(() => {
                character.style.animation = 'idle 2s ease-in-out infinite';
            }, 100);

            if (gameState.totalClicks % 10 === 0) {
                saveGame();
            }
        }

        function buyUpgrade(type) {
            let purchased = false;
            
            if (type === 'autoClicker') {
                const cost = Math.floor(10 * Math.pow(1.15, gameState.autoClickerLevel));
                if (gameState.points >= cost) {
                    gameState.points -= cost;
                    gameState.autoClickerLevel++;
                    gameState.pointsPerSecond = getEffectiveAutoClicker();
                    purchased = true;
                }
            } else if (type === 'clickPower') {
                const cost = Math.floor(50 * Math.pow(1.2, gameState.clickPowerLevel - 1));
                if (gameState.points >= cost) {
                    gameState.points -= cost;
                    gameState.clickPowerLevel++;
                    gameState.clickPower = gameState.clickPowerLevel;
                    purchased = true;
                }
            }
            
            if (purchased) {
                playSound('buySound');
                checkAchievements();
                saveGame();
            }
            
            updateDisplay();
        }

        function buyItem(itemId, cost) {
            if (gameState.points >= cost && !gameState.ownedItems.includes(itemId)) {
                gameState.points -= cost;
                gameState.ownedItems.push(itemId);
                
                playSound('buySound');
                
                updateDisplay();
                updateShop();
                checkAchievements();
                showNotification(`Item ${getItemName(itemId)} berhasil dibeli!`);
                
                saveGame();
            }
        }

        function equipItem(itemId) {
            if (gameState.equippedItems[itemId]) {
                gameState.equippedItems[itemId] = false;
            } else {
                gameState.equippedItems[itemId] = true;
            }
            updateEquipment();
            updateInventory();
            saveGame();
        }

        function getItemName(itemId) {
            for (let category in shopItems) {
                const item = shopItems[category].find(item => item.id === itemId);
                if (item) return item.name;
            }
            return itemId;
        }

        // ==================== PRESTIGE SYSTEM ====================
        function getEffectiveClickPower() {
            let power = gameState.clickPower;
            if (gameState.prestigeUpgrades.click_multiplier) {
                power *= 1.5;
            }
            return Math.floor(power * gameState.prestigeMultiplier);
        }

        function getEffectiveAutoClicker() {
            let auto = gameState.autoClickerLevel;
            if (gameState.prestigeUpgrades.auto_multiplier) {
                auto *= 2;
            }
            return Math.floor(auto * gameState.prestigeMultiplier);
        }

        function calculatePrestigePoints() {
            return Math.floor(Math.sqrt(gameState.points / 1000));
        }

        function canPrestige() {
            return gameState.points >= 1000;
        }

        function doPrestige() {
            if (!canPrestige()) return;
            
            const newPrestigePoints = calculatePrestigePoints();
            gameState.prestigePoints += newPrestigePoints;
            gameState.totalPrestigePoints += newPrestigePoints;
            gameState.prestigeLevel++;
            gameState.prestigeMultiplier = 1 + (gameState.prestigeLevel * 0.1);
            
            // Reset progress
            gameState.points = 0;
            gameState.clickPower = 1;
            gameState.autoClickerLevel = 0;
            gameState.clickPowerLevel = 1;
            gameState.pointsPerSecond = 0;
            gameState.ownedItems = [];
            gameState.equippedItems = {};
            
            updateDisplay();
            updateEquipment();
            updateShop();
            updateInventory();
            updatePrestigeDisplay();
            closePrestige();
            
            showNotification(`🌟 Prestige berhasil! Kamu mendapat ${newPrestigePoints} Prestige Points!`);
            saveGame();
        }

        function buyPrestigeUpgrade(upgradeId) {
            const upgrade = prestigeShop.find(u => u.id === upgradeId);
            if (!upgrade || gameState.prestigeUpgrades[upgradeId]) return;
            
            if (gameState.prestigePoints >= upgrade.cost) {
                gameState.prestigePoints -= upgrade.cost;
                gameState.prestigeUpgrades[upgradeId] = true;
                
                playSound('buySound');
                updatePrestigeDisplay();
                updatePrestigeShop();
                saveGame();
                
                showNotification(`🌟 ${upgrade.name} berhasil dibeli!`);
            }
        }

        // ==================== ACHIEVEMENT SYSTEM ====================
        function checkAchievements() {
            let newAchievements = [];
            
            // Check click achievements
            achievements.clicks.forEach(achievement => {
                if (!gameState.completedAchievements.includes(achievement.id) && 
                    gameState.totalClicks >= achievement.target) {
                    completeAchievement(achievement);
                    newAchievements.push(achievement);
                }
            });
            
            // Check points achievements
            achievements.points.forEach(achievement => {
                if (!gameState.completedAchievements.includes(achievement.id) && 
                    gameState.points >= achievement.target) {
                    completeAchievement(achievement);
                    newAchievements.push(achievement);
                }
            });
            
            // Check upgrade achievements
            if (!gameState.completedAchievements.includes('auto_1') && 
                gameState.autoClickerLevel >= 1) {
                const achievement = achievements.upgrades.find(a => a.id === 'auto_1');
                completeAchievement(achievement);
                newAchievements.push(achievement);
            }
            
            if (!gameState.completedAchievements.includes('auto_10') && 
                gameState.autoClickerLevel >= 10) {
                const achievement = achievements.upgrades.find(a => a.id === 'auto_10');
                completeAchievement(achievement);
                newAchievements.push(achievement);
            }
            
            if (!gameState.completedAchievements.includes('power_10') && 
                gameState.clickPowerLevel >= 10) {
                const achievement = achievements.upgrades.find(a => a.id === 'power_10');
                completeAchievement(achievement);
                newAchievements.push(achievement);
            }
            
            if (!gameState.completedAchievements.includes('first_item') && 
                gameState.ownedItems.length >= 1) {
                const achievement = achievements.upgrades.find(a => a.id === 'first_item');
                completeAchievement(achievement);
                newAchievements.push(achievement);
            }
            
            // Show notifications for new achievements
            newAchievements.forEach((achievement, index) => {
                setTimeout(() => {
                    showAchievementNotification(achievement);
                }, index * 2000);
            });
        }

        function completeAchievement(achievement) {
            gameState.completedAchievements.push(achievement.id);
            gameState.points += achievement.reward;
            console.log(`Achievement completed: ${achievement.name}`);
        }

        function showAchievementNotification(achievement) {
            const notification = document.getElementById('achievementNotification');
            notification.textContent = `🏆 ${achievement.name} (+${achievement.reward} poin)`;
            notification.classList.add('show');
                        setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // ==================== DAILY REWARDS SYSTEM ====================
        function checkDailyReward() {
            const now = Date.now();
            const lastReward = gameState.lastDailyReward;
            const oneDayMs = 24 * 60 * 60 * 1000;
            
            if (now - lastReward >= oneDayMs) {
                return true;
            }
            return false;
        }

        function claimDailyReward() {
            if (!checkDailyReward()) {
                showNotification('🎁 Daily reward sudah diklaim hari ini!');
                return;
            }
            
            const now = Date.now();
            const baseReward = 100;
            let multiplier = gameState.prestigeUpgrades.daily_bonus ? 2 : 1;
            
            // Check streak
            const lastReward = gameState.lastDailyReward;
            const oneDayMs = 24 * 60 * 60 * 1000;
            const twoDaysMs = 48 * 60 * 60 * 1000;
            
            if (lastReward === 0 || now - lastReward > twoDaysMs) {
                // Reset streak if more than 2 days
                gameState.dailyStreak = 1;
            } else if (now - lastReward >= oneDayMs) {
                // Continue streak
                gameState.dailyStreak++;
            }
            
            const streakBonus = Math.min(gameState.dailyStreak, 7);
            const reward = Math.floor(baseReward * multiplier * streakBonus);
            
            gameState.points += reward;
            gameState.lastDailyReward = now;
            
            const today = new Date().getDate();
            if (!gameState.dailyRewardsClaimed.includes(today)) {
                gameState.dailyRewardsClaimed.push(today);
            }
            
            updateDisplay();
            updateDailyCalendar();
            saveGame();
            
            showDailyRewardNotification(reward, gameState.dailyStreak);
            showNotification(`🎁 Daily reward diklaim! +${reward} poin (Streak: ${gameState.dailyStreak})`);
        }

        function showDailyRewardNotification(reward, streak) {
            const notification = document.getElementById('dailyRewardNotification');
            notification.textContent = `🎁 +${reward} poin (Streak: ${streak})`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function updateDailyCalendar() {
            const calendar = document.getElementById('dailyCalendar');
            calendar.innerHTML = '';
            
            const today = new Date();
            const currentDay = today.getDate();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            for (let day = 1; day <= 28; day++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'daily-day';
                
                const reward = 100 + (day * 10);
                
                if (gameState.dailyRewardsClaimed.includes(day)) {
                    dayDiv.classList.add('claimed');
                }
                
                if (day === currentDay) {
                    dayDiv.classList.add('today');
                }
                
                dayDiv.innerHTML = `
                    <div class="daily-day-number">Day ${day}</div>
                    <div class="daily-reward-amount">+${reward} poin</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
            
            // Update claim button
            const claimBtn = document.getElementById('claimDailyBtn');
            if (checkDailyReward()) {
                claimBtn.disabled = false;
                claimBtn.textContent = '🎁 Klaim Reward Harian';
            } else {
                claimBtn.disabled = true;
                claimBtn.textContent = '🎁 Sudah Diklaim Hari Ini';
            }
        }

        // ==================== OFFLINE EARNINGS SYSTEM ====================
        function checkOfflineEarnings() {
            const now = Date.now();
            const lastActive = gameState.lastActiveTime || now;
            const offlineTime = now - lastActive;
            const minOfflineTime = 2 * 60 * 1000; // 2 minutes minimum
            
            if (offlineTime >= minOfflineTime && gameState.pointsPerSecond > 0) {
                const maxOfflineHours = 8; // Maximum 8 hours of offline earnings
                const offlineHours = Math.min(offlineTime / (1000 * 60 * 60), maxOfflineHours);
                
                let multiplier = 1;
                if (gameState.prestigeUpgrades.offline_multiplier) {
                    multiplier = 3;
                }
                
                const offlineEarnings = Math.floor(gameState.pointsPerSecond * offlineHours * 3600 * 0.5 * multiplier);
                
                if (offlineEarnings > 0) {
                    showOfflineEarnings(offlineTime, offlineEarnings);
                }
            }
            
            gameState.lastActiveTime = now;
        }

        function showOfflineEarnings(offlineTime, earnings) {
            const hours = Math.floor(offlineTime / (1000 * 60 * 60));
            const minutes = Math.floor((offlineTime % (1000 * 60 * 60)) / (1000 * 60));
            
            let timeText = '';
            if (hours > 0) {
                timeText = `${hours} jam ${minutes} menit`;
            } else {
                timeText = `${minutes} menit`;
            }
            
            document.getElementById('offlineMessage').textContent = 
                `Kamu offline selama ${timeText} dan mendapat ${earnings} poin!`;
            
            gameState.points += earnings;
            updateDisplay();
            
            document.getElementById('offlinePopup').style.display = 'flex';
        }

        function closeOfflinePopup() {
            document.getElementById('offlinePopup').style.display = 'none';
            saveGame();
        }

        // ==================== UPDATE FUNCTIONS ====================
        function updateEquipment() {
            document.getElementById('hat').style.display = gameState.equippedItems.hat ? 'block' : 'none';
            document.getElementById('glasses').style.display = gameState.equippedItems.glasses ? 'block' : 'none';
            document.getElementById('vehicle').style.display = (gameState.equippedItems.motorcycle || gameState.equippedItems.car) ? 'block' : 'none';
        }

        function updateDisplay() {
            document.getElementById('points').textContent = Math.floor(gameState.points);
            document.getElementById('pointsPerSecond').textContent = gameState.pointsPerSecond;
            document.getElementById('totalClicks').textContent = gameState.totalClicks;
            document.getElementById('ownedItems').textContent = gameState.ownedItems.length;
            document.getElementById('level').textContent = Math.floor(gameState.totalClicks / 10) + 1;
            
            const autoClickerCost = Math.floor(10 * Math.pow(1.15, gameState.autoClickerLevel));
            const clickPowerCost = Math.floor(50 * Math.pow(1.2, gameState.clickPowerLevel - 1));
            
            document.getElementById('autoClickerCost').textContent = autoClickerCost;
            document.getElementById('clickPowerCost').textContent = clickPowerCost;
            document.getElementById('autoClickerLevel').textContent = gameState.autoClickerLevel;
            document.getElementById('clickPowerLevel').textContent = gameState.clickPowerLevel;
            
            const autoClickerBtn = document.getElementById('autoClickerBtn');
            const clickPowerBtn = document.getElementById('clickPowerBtn');
            
            if (gameState.points >= autoClickerCost) {
                autoClickerBtn.classList.add('available');
                autoClickerBtn.disabled = false;
            } else {
                autoClickerBtn.classList.remove('available');
                autoClickerBtn.disabled = false;
            }
            
            if (gameState.points >= clickPowerCost) {
                clickPowerBtn.classList.add('available');
                clickPowerBtn.disabled = false;
            } else {
                clickPowerBtn.classList.remove('available');
                clickPowerBtn.disabled = false;
            }

            updatePrestigeDisplay();
        }

        function updatePrestigeDisplay() {
            document.getElementById('prestigeLevel').textContent = gameState.prestigeLevel;
            document.getElementById('prestigePoints').textContent = gameState.prestigePoints;
            document.getElementById('prestigeMultiplier').textContent = gameState.prestigeMultiplier.toFixed(1);
            document.getElementById('dailyStreak').textContent = gameState.dailyStreak;
            
            const prestigeBtn = document.getElementById('prestigeBtn');
            const nextPrestigePoints = calculatePrestigePoints();
            
            if (canPrestige()) {
                prestigeBtn.disabled = false;
                prestigeBtn.textContent = `🌟 Prestige (+${nextPrestigePoints} PP)`;
            } else {
                prestigeBtn.disabled = true;
                prestigeBtn.textContent = `🌟 Prestige (Need 1000 Points)`;
            }
            
            document.getElementById('nextPrestigePoints').textContent = nextPrestigePoints;
            document.getElementById('doPrestigeBtn').disabled = !canPrestige();
        }

        function updateShop() {
            updateShopGrid('accessories', 'accessoriesGrid');
            updateShopGrid('characters', 'charactersGrid');
            updateShopGrid('themes', 'themesGrid');
        }

        function updateShopGrid(category, gridId) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            shopItems[category].forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'shop-item';
                
                const isOwned = gameState.ownedItems.includes(item.id);
                const canAfford = gameState.points >= item.price;
                
                itemDiv.innerHTML = `
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-price">💰 ${item.price} poin</div>
                    <button class="buy-btn ${isOwned ? 'owned' : ''}" 
                            onclick="${isOwned ? '' : `buyItem('${item.id}', ${item.price})`}"
                            ${!canAfford && !isOwned ? 'disabled' : ''}>
                        ${isOwned ? '✓ Terbeli' : 'Beli'}
                    </button>
                `;
                
                grid.appendChild(itemDiv);
            });
        }

        function updateInventory() {
            const inventoryGrid = document.getElementById('inventoryGrid');
            inventoryGrid.innerHTML = '';
            
            if (gameState.ownedItems.length === 0) {
                inventoryGrid.innerHTML = '<div style="text-align: center; color: #666; grid-column: 1 / -1; padding: 50px;">Belum ada item yang dimiliki</div>';
                return;
            }
            
            gameState.ownedItems.forEach(itemId => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'inventory-item';
                
                const icons = {
                    hat: '🎩', glasses: '🕶️', motorcycle: '🏍️', car: '🚗',
                    wizard: '🧙‍♂️', superhero: '🦸‍♂️', darkTheme: '🌙', rainbowTheme: '🌈'
                };
                
                const isEquipped = gameState.equippedItems[itemId];
                
                itemDiv.innerHTML = `
                    <div class="item-icon">${icons[itemId] || '❓'}</div>
                    <div class="item-name">${getItemName(itemId)}</div>
                    <button class="equip-btn ${isEquipped ? 'equipped' : ''}" onclick="equipItem('${itemId}')">
                        ${isEquipped ? 'Lepas' : 'Pasang'}
                    </button>
                `;
                
                inventoryGrid.appendChild(itemDiv);
            });
        }

        function updateAchievements() {
            updateAchievementGrid('clicks', 'clicksAchievementGrid');
            updateAchievementGrid('points', 'pointsAchievementGrid');
            updateAchievementGrid('upgrades', 'upgradesAchievementGrid');
        }

        function updateAchievementGrid(category, gridId) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            achievements[category].forEach(achievement => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'achievement-item';
                
                const isCompleted = gameState.completedAchievements.includes(achievement.id);
                if (isCompleted) {
                    itemDiv.classList.add('completed');
                }
                
                let currentProgress = 0;
                if (category === 'clicks') {
                    currentProgress = gameState.totalClicks;
                } else if (category === 'points') {
                    currentProgress = gameState.points;
                } else if (category === 'upgrades') {
                    if (achievement.id === 'auto_1' || achievement.id === 'auto_10') {
                        currentProgress = gameState.autoClickerLevel;
                    } else if (achievement.id === 'power_10') {
                        currentProgress = gameState.clickPowerLevel;
                    } else if (achievement.id === 'first_item') {
                        currentProgress = gameState.ownedItems.length;
                    }
                }
                
                const progressPercent = Math.min((currentProgress / achievement.target) * 100, 100);
                
                itemDiv.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-desc">${achievement.desc}</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar ${isCompleted ? 'completed' : ''}" 
                             style="width: ${progressPercent}%"></div>
                    </div>
                    <div class="achievement-reward">
                        ${isCompleted ? '✓ Completed' : `Reward: ${achievement.reward} poin`}
                    </div>
                `;
                
                grid.appendChild(itemDiv);
            });
        }

        function updatePrestigeShop() {
            const grid = document.getElementById('prestigeShopGrid');
            grid.innerHTML = '';
            
            prestigeShop.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'prestige-item';
                
                const isOwned = gameState.prestigeUpgrades[item.id];
                const canAfford = gameState.prestigePoints >= item.cost;
                
                if (isOwned) {
                    itemDiv.classList.add('owned');
                }
                
                itemDiv.innerHTML = `
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-price">⭐ ${item.cost} PP</div>
                    <div class="achievement-desc">${item.desc}</div>
                    <button class="buy-btn ${isOwned ? 'owned' : ''}" 
                            onclick="${isOwned ? '' : `buyPrestigeUpgrade('${item.id}')`}"
                            ${!canAfford && !isOwned ? 'disabled' : ''}>
                        ${isOwned ? '✓ Owned' : 'Buy'}
                    </button>
                `;
                
                grid.appendChild(itemDiv);
            });
        }

        // ==================== UI FUNCTIONS ====================
        function openShop() {
            playSound('openSound');
            updateShop();
            document.getElementById('shopPopup').style.display = 'flex';
        }

        function closeShop() {
            playSound('closeSound');
            document.getElementById('shopPopup').style.display = 'none';
        }

        function openInventory() {
            playSound('openSound');
            updateInventory();
            document.getElementById('inventoryPopup').style.display = 'flex';
        }

        function closeInventory() {
            playSound('closeSound');
            document.getElementById('inventoryPopup').style.display = 'none';
        }

        function openAchievements() {
            playSound('openSound');
            updateAchievements();
            updateDailyCalendar();
            document.getElementById('achievementsPopup').style.display = 'flex';
        }

        function closeAchievements() {
            playSound('closeSound');
            document.getElementById('achievementsPopup').style.display = 'none';
        }

        function openPrestige() {
            playSound('openSound');
            updatePrestigeShop();
            updatePrestigeDisplay();
            document.getElementById('prestigePopup').style.display = 'flex';
        }

        function closePrestige() {
            playSound('closeSound');
            document.getElementById('prestigePopup').style.display = 'none';
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function switchAchievementTab(tabName) {
            document.querySelectorAll('#achievementsPopup .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('#achievementsPopup .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Achievements').classList.add('active');
            event.target.classList.add('active');
        }

        function switchPrestigeTab(tabName) {
            document.querySelectorAll('#prestigePopup .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('#prestigePopup .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById('prestige' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.add('active');
            event.target.classList.add('active');
        }

        function showNotification(message) {
            document.getElementById('notificationMessage').textContent = message;
            document.getElementById('notificationPopup').style.display = 'flex';
        }

        function closeNotification() {
            playSound('closeSound');
            document.getElementById('notificationPopup').style.display = 'none';
        }

        function confirmReset() {
            document.getElementById('resetPopup').style.display = 'flex';
        }

        function closeResetPopup() {
            document.getElementById('resetPopup').style.display = 'none';
        }

        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            document.getElementById('soundStatus').textContent = gameState.soundEnabled ? 'On' : 'Off';
            
            if (gameState.soundEnabled) {
                playSound('clickSound');
            }
            
            saveGame();
        }

        function showSaveStatus(message, isError = false) {
            const saveStatus = document.getElementById('saveStatus');
            saveStatus.textContent = message;
            saveStatus.classList.toggle('error', isError);
            saveStatus.classList.add('show');
            
            setTimeout(() => {
                saveStatus.classList.remove('show');
            }, 2000);
        }

        // ==================== GAME LOOP ====================
        setInterval(() => {
            gameState.points += gameState.pointsPerSecond;
            gameState.playTime++;
            gameState.totalPlaytime++;
            document.getElementById('playTime').textContent = gameState.playTime;
            updateDisplay();
        }, 1000);

        // ==================== INITIALIZE GAME ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved game data
            const loaded = loadGame();
            
            // Check offline earnings if game was loaded
            if (loaded) {
                setTimeout(() => {
                    checkOfflineEarnings();
                }, 1000);
            }
            
            // Initialize audio
            preloadAudio();
            
            // Initialize auto save system
            initAutoSave();
            
            // Update all displays
            updateDisplay();
            updateEquipment();
            updateShop();
            updateInventory();
            updateAchievements();
            updatePrestigeDisplay();
            updateDailyCalendar();
            
            // Update sound status
            document.getElementById('soundStatus').textContent = gameState.soundEnabled ? 'On' : 'Off';
            
            // Check for daily rewards
            if (checkDailyReward() && gameState.totalClicks > 0) {
                setTimeout(() => {
                    showNotification('🎁 Daily reward tersedia! Buka menu Prestasi untuk mengklaim.');
                }, 3000);
            }
            
            console.log('Game initialized!', loaded ? 'Saved data loaded.' : 'Starting fresh.');
        });
    </script>
</body>
</html>
